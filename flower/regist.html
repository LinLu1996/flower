<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="css/base.css" />
    <link rel="stylesheet" type="text/css" href="css/index.css" />
    <link rel="stylesheet" type="text/css" href="css/regist.css" />
    <script src="js/jquery-3.2.1.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/index.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/regist.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>
    <div class="top">
        <div class="w">
            <div class="top-left fl">
                <s>欢迎光临本店</s>
                <a href="#">请登录</a>
                <a href="#">免费注册</a>
            </div>
            <div class="top-right fr">
                <ul>
                    <li class="top-infor">
                        <a href="#">
                            我的信息
                            <span></span>
                        </a>
                        <div class="top-infor-list">
                            <a href="#">已买到的宝贝</a>
                            <a href="#">我的地址管理</a>
                        </div>
                    </li>
                    <li class="top-shoucang">
                        <a href="#">我的收藏</a>
                    </li>
                    <li class="line"></li>
                    <li class="top-cart">
                        <a href="#">购物车</a>
                    </li>
                    <li class="line"></li>
                    <li class="top-phone">
                        <s></s>
                        <a href="#">花博士手机<span></span></a>
                        <div class="top-phone-er">
                            <img src="img/top-er.png" />
                            <p>下载手机APP</p>
                            <p>自己当店长</p>
                        </div>
                    </li>
                    <li class="top-fo">
                        <s></s>
                        <a href="#">关注花博士<span></span></a>
                        <div class="top-phone-er">
                            <img src="img/top-er2.png" />
                            <p>下载手机APP</p>
                            <p>自己当店长</p>
                        </div>
                    </li>
                    <li class="top-agree">
                        <a href="#">商家支持<span></span></a>
                        <div class="top-agree-list">
                            <div class="top-agree-list-a">
                                <p>商家：</p>
                                <a href="#">售后流程</a>
                                <a href="#" class="shopping">购物流程</a>
                                <a href="#">订购方式</a>
                                <a href="#" class="shopping">常见问题</a>
                            </div>
                            <div class="top-agree-list-b">
                                <p>帮助：</p>
                                <a href="#">帮助中心</a>
                            </div>
                        </div>
                    </li>
                    <li class="line"></li>
                    <li class="top-last"><s></s>
                        <a href="#">商家入驻</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="logo clearfix">
        <div class="w logo-a">
            <div class="logo-flower fl">
                <img src="img/logo.gif" />
            </div>
            <div class="logo-city fl">
                <p class="logo-all">全国站</p>
                <div class="logo-allcity">
                    <a href="#" class="logo-change">切换城市</a>
                </div>
            </div>
            <div class="logo-form fl">
                <form action="" method="">
                    <input class="text fl" name="" id="" placeholder="请输入关键字" />
                    <input class="button fl" value="搜索" />
                </form>
                <div class="logo-form-bot">
                    <ul>
                        <li>
                            <a href="#">玫瑰</a>
                        </li>
                        <li class="line"></li>
                        <li>
                            <a href="#">百合</a>
                        </li>
                        <li class="line"></li>
                        <li>
                            <a href="#">康乃馨</a>
                        </li>
                        <li class="line"></li>
                        <li>
                            <a href="#">绿植</a>
                        </li>
                        <li class="line"></li>
                        <li>
                            <a href="#">爱情</a>
                        </li>
                        <li class="line"></li>
                        <li>
                            <a href="#">生日</a>
                        </li>
                        <li class="line"></li>
                        <li>
                            <a href="#">开业</a>
                        </li>
                        <li class="line"></li>
                        <li>
                            <a href="#">商务用花</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="logo-tu fl">
                <img src="img/biao.png" />
            </div>
            <div class="logo-server fr">
                <a href="#">
                    <span></span> 在线客服
                </a>
            </div>
        </div>
    </div>
    <div class="login-wraper">
        <div class="container">
            <div class="login-box">
                <ul class="login-tabs">
                    <li class="active"><a href="">注册</a></li>
                    <li><a href="javascript:void(0)">登录</a></li>
                </ul>
                <form action="" method="post" id="regist" onsubmit=handleSubmit()>
                    <div class="tab-content">
                        <div class="form-group">
                            <input type="text" name="phone" id="phone" placeholder="请填写您手机号码">
                            <span class="error-msg">手机号码不合法或已存在</span>
                        </div>
                        <div class="form-group">
                            <input type="password" name="pwd" id="pwd" value="" placeholder="6-20位密码"  data-validate="false"/>
                            <span class="error-msg">密码不合法</span>
                        </div>
                        <div class="form-group">
                            <input type="password" name="repwd" id="repwd" value="" placeholder="确认密码"/>
                            <span class="error-msg">确认密码和密码不一致</span>
                        </div>
                        <button type="submit" id="btn">立即注册</button>
                    </div>
                </form>
                <form action="" method="post" id="login">
                    <div class="tab-content">
                        <div class="form-group">
                            <input type="text" name="phone" id="phone1" placeholder="请填写您手机号码">
                            <span class="error-msg">手机号码不正确</span>
                        </div>
                        <div class="form-group">
                            <input type="password" name="pwd" id="pwd1" value="" placeholder="6-20位密码"  data-validate="false"/>
                            <span class="error-msg">密码不正确</span>
                        </div>
                        <button type="submit" id="btn" onclick=handleLogin()>登录</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script>
        function handleSubmit(e){
            e =e || event;
            e.preventDefault();
            console.log(111);
            let form =document.getElementById('regist');
            let url = "http://localhost:3000/user/add";
            let phone =document.getElementById("phone").value;
            let pwd =document.getElementById('pwd').value;
            let data ={
                phone,
                pwd
            }
            fetch(url,{
                method: "post",
                body: JSON.stringify(data)
            })
           .then(resp =>resp.json()) 
           .then(data =>{
               console.log(data.id)
               form.reset();
           })
           .catch(e=>console.log(e));
        }
        function handleLogin(e){
            // e.preventDefault();
            e =e || event;
            e.preventDefault();
            let url = "http://localhost:3000/user/login";
            let phone =document.getElementById("phone1").value;
            let pwd =document.getElementById('pwd1').value;
            let data ={
                phone,
                pwd
            }
            sessionStorage.setItem("user",JSON.stringify(data.phone));
            fetch(url,{
                method: "post",
                body: JSON.stringify(data)
            })
           .then(resp =>resp.json()) 
           .then(data =>{
               console.log(data.status);
               if(data.status =="ok"){
                  window.location.href="file:///Users/igeekhome/web/flower/index.html"
               }
               if(data.status =="no"){
                   sessionStorage.removeItem("user");
               }
           })
           .catch(e=>console.log(e));
        }
    </script>
</body>
</html>
